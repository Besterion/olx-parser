name: CI - Build & OLX Parser

on:
  push:
    branches: [ master ]
  schedule:
    - cron: "*/5 * * * *" # –ö–æ–∂–Ω—ñ 5 —Ö–≤
  workflow_dispatch:

jobs:
  build:
    if: github.event_name == 'push' || github.event_name == 'workflow_dispatch'
    runs-on: ubuntu-latest

    steps:
      - uses: actions/checkout@v3

      - name: Setup .NET
        uses: actions/setup-dotnet@v3
        with:
          dotnet-version: 8.0.x

      - name: Restore dependencies
        run: dotnet restore

      - name: Build
        run: dotnet build --no-restore

  run-parser:
    # –û—Å—å —Ç—É—Ç –∑–º—ñ–Ω–∞: –¥–æ–¥–∞–π—Ç–µ 'github.event_name == 'push' ||'
    if: github.event_name == 'push' || github.event_name == 'schedule' || github.event_name == 'workflow_dispatch'
    runs-on: ubuntu-latest

    steps:
      - name: üõé –ö–ª–æ–Ω—É–≤–∞–Ω–Ω—è —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—é
        uses: actions/checkout@v3

      - name: ‚öôÔ∏è –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è .NET
        uses: actions/setup-dotnet@v4
        with:
          dotnet-version: '8.0.x'

      - name: üì¶ Restore
        run: dotnet restore

      - name: üî® Build
        run: dotnet build --configuration Release

      - name: üöÄ –ó–∞–ø—É—Å–∫ –ø–∞—Ä—Å–µ—Ä–∞
        run: dotnet run --project OLXParserBot.csproj